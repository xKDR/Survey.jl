<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Generalised linear models · Survey.jl</title><meta name="title" content="Generalised linear models · Survey.jl"/><meta property="og:title" content="Generalised linear models · Survey.jl"/><meta property="twitter:title" content="Generalised linear models · Survey.jl"/><meta name="description" content="Documentation for Survey.jl."/><meta property="og:description" content="Documentation for Survey.jl."/><meta property="twitter:description" content="Documentation for Survey.jl."/><meta property="og:url" content="https://xKDR.github.io/Survey.jl/man/glm/"/><meta property="twitter:url" content="https://xKDR.github.io/Survey.jl/man/glm/"/><link rel="canonical" href="https://xKDR.github.io/Survey.jl/man/glm/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Survey.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../dataframes/">DataFrames in Survey</a></li><li><a class="tocitem" href="../replicate/">Replicate weights</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../comparisons/">Comparison with other survey analysis tools</a></li><li class="is-active"><a class="tocitem" href>Generalised linear models</a><ul class="internal"><li><a class="tocitem" href="#Fitting-a-GLM-to-a-Survey-Design-object"><span>Fitting a GLM to a Survey Design object</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Generalised linear models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Generalised linear models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/xKDR/Survey.jl/blob/main/docs/src/man/glm.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Generalized-Linear-Models-in-Survey"><a class="docs-heading-anchor" href="#Generalized-Linear-Models-in-Survey">Generalized Linear Models in Survey</a><a id="Generalized-Linear-Models-in-Survey-1"></a><a class="docs-heading-anchor-permalink" href="#Generalized-Linear-Models-in-Survey" title="Permalink"></a></h1><p>The <code>glm()</code> function in the Julia Survey package is used to fit generalized linear models (GLMs) to survey data. It incorporates survey design information, such as sampling weights, stratification, and clustering, to produce valid estimates and standard errors that account for the type of survey design.</p><p>As of June 2023, the <a href="https://juliastats.org/GLM.jl/stable/">GLM.jl documentation</a> lists the supported distribution families and their link functions as:</p><pre><code class="language-txt hljs">Bernoulli (LogitLink)
Binomial (LogitLink)
Gamma (InverseLink)
InverseGaussian (InverseSquareLink)
NegativeBinomial (NegativeBinomialLink, often used with LogLink)
Normal (IdentityLink)
Poisson (LogLink)</code></pre><p>Refer to the GLM.jl documentation for more information about the GLM package.</p><h2 id="Fitting-a-GLM-to-a-Survey-Design-object"><a class="docs-heading-anchor" href="#Fitting-a-GLM-to-a-Survey-Design-object">Fitting a GLM to a Survey Design object</a><a id="Fitting-a-GLM-to-a-Survey-Design-object-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-a-GLM-to-a-Survey-Design-object" title="Permalink"></a></h2><p>You can fit a GLM to a Survey Design object the same way you would fit it to a regular data frame. The only difference is that you need to specify the survey design object as the second argument to the <code>glm()</code> function.</p><pre><code class="language-julia hljs">using Survey
apisrs = load_data(&quot;apisrs&quot;) 

# Simple random sample survey
srs = SurveyDesign(apisrs, weights = :pw) 

# Survey stratified by stype
dstrat = SurveyDesign(apistrat, strata = :stype, weights = :pw) 

# Survey clustered by dnum
dclus1 = SurveyDesign(apiclus1, clusters = :dnum, weights = :pw) </code></pre><p>Once you have the survey design object, you can fit a GLM using the <code>glm()</code> function. Specify the formula for the model and the distribution family. </p><p>The <code>glm()</code> function supports all distribution families supported by GLM.jl, i.e. Bernoulli, Binomial, Gamma, Geometric, InverseGaussian, NegativeBinomial, Normal, and Poisson. </p><p>For example, to fit a GLM with a Bernoulli distribution and a Logit link function to the <code>srs</code> survey design object we created above:</p><pre><code class="language-julia hljs">formula = @formula(api00 ~ api99)
my_glm = glm(formula, srs, family = Normal())

# View the coefficients and standard errors
my_glm.Coefficients
my_glm.SE</code></pre><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>The examples below use the <code>api</code> datasets, which contain survey data collected about California schools. The datasets are included in the Survey.jl package and can be loaded by calling <code>load_data(&quot;name_of_dataset&quot;)</code>.</p><h3 id="Bernoulli-with-Logit-Link"><a class="docs-heading-anchor" href="#Bernoulli-with-Logit-Link">Bernoulli with Logit Link</a><a id="Bernoulli-with-Logit-Link-1"></a><a class="docs-heading-anchor-permalink" href="#Bernoulli-with-Logit-Link" title="Permalink"></a></h3><p>A school being eligible for the awards program (<code>awards</code>) is a binary outcome (0 or 1). Let&#39;s assume it follows a Bernoulli distribution. Suppose we want to predict <code>awards</code> based on the percentage of students eligible for subsidized meals (<code>meals</code>) and the percentage of English Language Learners (<code>ell</code>). We can fit this GLM using the code below:</p><pre><code class="language-julia hljs">using Survey
apisrs = load_data(&quot;apisrs&quot;)
srs = SurveyDesign(apisrs, weights = :pw) 

# Convert yes/no to 1/0
apisrs.awards = ifelse.(apisrs.awards .== &quot;Yes&quot;, 1, 0)

# Fit the model
model = glm(@formula(awards ~ meals + ell), apisrs, Bernoulli(), LogitLink())</code></pre><h3 id="Poisson-with-Log-Link"><a class="docs-heading-anchor" href="#Poisson-with-Log-Link">Poisson with Log Link</a><a id="Poisson-with-Log-Link-1"></a><a class="docs-heading-anchor-permalink" href="#Poisson-with-Log-Link" title="Permalink"></a></h3><p>Let us assume that the number of students tested (<code>api_stu</code>) follows a Poisson distribution, which models the number of successes out of a fixed number of trials. Suppose we want to predict the number of students tested based on the percentage of students eligible for subsidized meals (<code>meals</code>) and the percentage of English Language Learners (<code>ell</code>). We can fit this GLM using the code below:</p><pre><code class="language-julia hljs">using Survey
apisrs = load_data(&quot;apisrs&quot;)
srs = SurveyDesign(apisrs, weights = :pw) 

# Rename api.stu to api_stu
rename!(apisrs, Symbol(&quot;api.stu&quot;) =&gt; :api_stu)

# Fit the model
model = glm(@formula(api_stu ~ meals + ell), apisrs, Poisson(), LogLink())</code></pre><h3 id="Gamma-with-Inverse-Link"><a class="docs-heading-anchor" href="#Gamma-with-Inverse-Link">Gamma with Inverse Link</a><a id="Gamma-with-Inverse-Link-1"></a><a class="docs-heading-anchor-permalink" href="#Gamma-with-Inverse-Link" title="Permalink"></a></h3><p>Let us assume that the average parental education level (<code>avg_ed</code>) follows a Gamma distribution, which is suitable for modeling continuous, positive-valued variables with a skewed distribution. Suppose we want to predict the average parental education level based on the percentage of students eligible for subsidized meals (<code>meals</code>) and the percentage of English Language Learners (<code>ell</code>). We can fit this GLM using the code below:</p><pre><code class="language-julia hljs">using Survey
apisrs = load_data(&quot;apisrs&quot;)
srs = SurveyDesign(apisrs, weights = :pw) 

# Rename api.stu to api_stu
rename!(apisrs, Symbol(&quot;avg.ed&quot;) =&gt; :avg_ed)

# Fit the model
model = glm(@formula(avg_ed  ~ meals + ell), apisrs, Gamma(), InverseLink())</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../comparisons/">« Comparison with other survey analysis tools</a><a class="docs-footer-nextpage" href="../../api/">API reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 22 December 2023 10:50">Friday 22 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
